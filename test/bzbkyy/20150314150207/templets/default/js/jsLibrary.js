function swaper(ctlList,conList,ctlCCSS,ctlNCSS,auto,speed){this.ctlList=ctlList;this.conList=conList;this.speed=speed;this.auto=auto;this.ctlCCSS=ctlCCSS;this.ctlNCSS=ctlNCSS;this.cTurn=0;this.tagTurn=1;this.init();var _this=this;if(this.auto=="1"){this.player=setInterval(function(){_this.play()},this.speed)}}swaper.prototype={init:function(){if(typeof(this.ctlList)!="object"||typeof(this.conList)!="object"){alert("parameters error!")}for(var i=0;i<this.ctlList.length;i++){this.ctlList[i]=g$(this.ctlList[i]);this.ctlList[i].orderNum=i;this.conList[i]=g$(this.conList[i]);if(this.conList[i].currentStyle){this.conList[i].status=this.conList[i].currentStyle["display"]}else{this.conList[i].status=document.defaultView.getComputedStyle(this.conList[i],false)['display']}if(i==this.cTurn){if(this.ctlCCSS){this.ctlList[i].className=this.ctlCCSS}this.conList[i].style.display=""}else{if(this.ctlCCSS){this.ctlList[i].className=this.ctlNCSS}this.conList[i].style.display="none"}var _this=this;this.ctlList[i].onmouseover=function(){clearInterval(_this.player);_this.tagTurn=this.orderNum;_this.swapObj()};if(this.auto==1){this.ctlList[i].onmouseout=function(){_this.player=setInterval(function(){_this.play()},_this.speed)}}}},swapObj:function(){if(this.tagTurn!=this.cTurn){this.ctlList[this.tagTurn].className=this.ctlCCSS;this.ctlList[this.cTurn].className=this.ctlNCSS;this.conList[this.cTurn].style.display="none";this.conList[this.tagTurn].style.display=this.conList[this.tagTurn].status?this.conList[this.tagTurn].status:"block";this.cTurn=this.tagTurn}},play:function(){var _this=this;this.tagTurn=this.cTurn+1;if(this.tagTurn==this.ctlList.length){this.tagTurn=0}this.swapObj()}};function g$(str){if(typeof(str)=="object"){return str}else{if(document.getElementById(str)){return document.getElementById(str)}}}function slide(target,width,height,ctrColor,speed,stay){this.target=arguments[0];this.width=arguments[1];this.height=arguments[2];this.ctrlColor=arguments[3]?arguments[3]:"8EBBD0";this.speed=arguments[4]?arguments[4]:20;this.stay=arguments[5]?arguments[5]:5000;this.space=10;this.cMoveWidth=0;this.targetSpace=this.width;this.moveSide="l";this.currentNum=0;this.targetNum=0;this.itemNum=0;this.ctrlCss="";this.cItemNcss="";this.cItemCcss="";this.ctrlList=new Array();this.status=0;this.order="";this.mover;this.player;this.init();this.target.parentNode.appendChild(this.createCtrl());this.play();var _this=this;if(window.attachEvent){window.attachEvent("onload",function(){_this.resetStatus()})}else if(window.addEventListener){window.addEventListener("load",function(){_this.resetStatus()},false)}}slide.prototype={init:function(){var mainBox=document.getElementById(this.target);this.target=document.createElement("div");this.target.style.cssText="width:"+this.width+"px; height:"+this.height+"px; overflow:hidden;";this.target.innerHTML=mainBox.innerHTML;mainBox.innerHTML="";mainBox.style.position="relative";mainBox.appendChild(this.target);if(this.target&&this.target.innerHTML!=""&&this.width&&this.height){var list=this.target.getElementsByTagName("ul");var iSet=this.target.getElementsByTagName("li");list[0].style.width=iSet.length*this.width+"px";list[0].style.overflow="hidden";this.itemNum=iSet.length}},createCtrl:function(num){this.ctrlCss="width:"+(this.itemNum*30)+"px; height:20px; position:absolute; right:5px; bottom:10px; z-index:10";this.cItemNcss='float:left; display:inline; margin:0px 5px; width:20px; height:20px; font:bold 12px Arial; line-height:20px; text-align:center; color:#'+this.ctrlColor+'; background:#fff; cursor:pointer';this.cItemCcss='float:left; display:inline; margin:0px 5px; width:20px; height:20px; font:bold 12px Arial; line-height:20px; text-align:center; color:#fff; background:#'+this.ctrlColor+'; cursor:pointer';var ctrl=document.createElement("div");ctrl.style.cssText=this.ctrlCss;for(var i=0;i<this.itemNum;i++){var tempItem=document.createElement("div");tempItem.innerHTML=i+1;tempItem.style.cssText=this.cItemNcss;tempItem.orderNum=i;var _this=this;tempItem.onclick=function(){if(_this.status){_this.pause();_this.play(this.orderNum)}else{_this.order=this.orderNum}};this.ctrlList[i]=tempItem;ctrl.appendChild(tempItem)}return ctrl},resetStatus:function(){clearTimeout(this.mover);clearTimeout(this.player);this.currentNum=0;this.targetNum=0;this.target.scrollLeft=0;this.cMoveWidth=0;var _this=this;this.ctrlList[0].style.cssText=this.cItemCcss;this.ctrlList[1].style.cssText=this.cItemNcss;this.status=1;this.player=setTimeout(function(){_this.play()},_this.stay)},move:function(){sourceSpace=this.space;this.space=Math.round((this.targetSpace-this.cMoveWidth)*0.1);this.space=this.space<sourceSpace?sourceSpace:this.space;this.cMoveWidth+=this.space;if(this.cMoveWidth>this.targetSpace){this.space=this.space-(this.cMoveWidth-this.targetSpace);this.cMoveWidth=this.targetSpace}if(this.moveSide=="l"){this.target.scrollLeft+=this.space}else{this.target.scrollLeft-=this.space}this.space=sourceSpace;var _this=this;if(this.cMoveWidth!=this.targetSpace){this.status=0;this.mover=setTimeout(function(){_this.move()},_this.speed)}else{this.cMoveWidth=0;this.status=1;if(this.order!=""){this.pause();var target=this.order;this.order="";this.play(target)}else{this.player=setTimeout(function(){_this.play()},_this.stay)}}},play:function(targetNum){this.currentNum=this.targetNum;this.targetNum=targetNum!=null?targetNum:(this.targetNum+1);this.targetNum=this.targetNum>=this.itemNum?0:this.targetNum;this.ctrlList[this.currentNum].style.cssText=this.cItemNcss;this.ctrlList[this.targetNum].style.cssText=this.cItemCcss;this.moveSide=(this.targetNum>this.currentNum)?"l":"r";var targetSpace=Math.abs(this.targetNum-this.currentNum)*this.width;this.targetSpace=targetSpace;this.move()},pause:function(){clearTimeout(this.mover);clearTimeout(this.player)}};function marquee(targetBox,moveDirection){this.speed=30;this.bigBox=targetBox;this.moveSocurce="";this.moveCopy="";this.direction=moveDirection;this.moveStart()}marquee.prototype={move:function(){if(this.direction=="top"){if(this.moveCopy.offsetHeight*2-this.bigBox.offsetHeight>this.bigBox.scrollTop){this.bigBox.scrollTop++}else{this.bigBox.scrollTop=this.moveSocurce.offsetHeight-this.bigBox.clientHeight}}else{if(this.moveCopy.offsetWidth*2-this.bigBox.clientWidth>this.bigBox.scrollLeft){this.bigBox.scrollLeft++}else{this.bigBox.scrollLeft=this.moveSocurce.offsetWidth-this.bigBox.clientWidth}}},moveStart:function(){this.bigBox=document.getElementById(this.bigBox);this.moveSocurce=document.createElement("div");this.moveCopy=document.createElement("div");if(this.bigBox==null){alert("对象初始化不成功，请检查参数！")}else{this.moveSocurce.innerHTML=this.bigBox.innerHTML;this.moveSocurce.style.overflow="hidden";this.moveCopy.innerHTML=this.bigBox.innerHTML;this.moveCopy.style.overflow="hidden";this.bigBox.style.overflow="hidden";this.bigBox.style.width=this.bigBox.clientWidth+"px";this.bigBox.style.height=this.bigBox.clientHeight+"px";this.bigBox.style.overflow="hidden";var tempObj=document.createElement("div");if(this.direction!="top"){tempObj.style.width=this.bigBox.scrollWidth*2+"px";this.moveSocurce.style.styleFloat="left";this.moveSocurce.style.cssFloat="left";this.moveCopy.style.styleFloat="left";this.moveCopy.style.cssFloat="left"}tempObj.appendChild(this.moveSocurce);tempObj.appendChild(this.moveCopy);this.bigBox.innerHTML="";this.bigBox.appendChild(tempObj);var tempObj=this;var MyMar=setInterval(function(){tempObj.move()},this.speed);this.bigBox.onmouseover=function(){clearInterval(MyMar)};this.bigBox.onmouseout=function(){MyMar=setInterval(function(){tempObj.move()},tempObj.speed)}}}};function movebyctrl(target,lctrl,rctrl,viewWidth,itemWidth,direction,speed,stay){this.target=arguments[0];this.lctrl=arguments[1];this.rctrl=arguments[2];this.viewWidth=arguments[3];this.itemWidth=arguments[4];this.direction=arguments[5]==null?"left":arguments[5];this.speed=arguments[6]==null?30:arguments[6];this.stay=arguments[7]==null?3000:arguments[7];this.c1=document.createElement("div");this.c2=document.createElement("div");this.moveTimer=null;this.stayTimer=null;this.cMoveWidth=0;this.space=10;this.moveSide="l";this.Order=null;this.init();this.play();var _this=this;if(window.attachEvent){window.attachEvent("onload",function(){_this.resetStatus()})}else if(window.addEventListener){window.addEventListener("load",function(){_this.resetStatus()},false)}}movebyctrl.prototype={init:function(){if(!this.target||!g$(this.target)){return}this.setCont();var _this=this;this.target.onmouseover=function(){_this.stopMove()};this.target.onmouseout=function(){_this.play()};this.lctrl=g$(this.lctrl);this.rctrl=g$(this.rctrl);this.lctrl.onclick=function(){_this.btnAct("r")};this.rctrl.onclick=function(){_this.btnAct("l")}},setCont:function(){this.target=g$(this.target);var bigCont=document.createElement("div");this.c1.innerHTML=this.c2.innerHTML=this.target.innerHTML;this.c1.style.overflow=this.c2.style.overflow="hidden";this.target.innerHTML="";this.target.style.overflow="hidden";bigCont.style.overflow='hidden';bigCont.appendChild(this.c1);bigCont.appendChild(this.c2);this.target.appendChild(bigCont);if(this.direction=="left"){this.target.style.width=this.viewWidth;this.c1.style.cssFloat=this.c2.style.cssFloat='left';this.c1.style.styleFloat=this.c2.style.styleFloat='left';this.c1.style.display=this.c2.style.display="inline";bigCont.style.width=this.c1.scrollWidth*2+"px"}else if(this.direction=="top"){this.target.style.height=this.viewWidth+"px"}},move:function(){if(this.direction=="left"){this.moveLeft()}else if(this.direction=="top"){this.moveTop()}},moveLeft:function(){if(this.c1.scrollWidth*2-this.target.clientWidth>this.target.scrollLeft){sourceSpace=this.space;this.cMoveWidth+=this.space;if(this.cMoveWidth>this.itemWidth){this.space=this.space-(this.cMoveWidth-this.itemWidth);this.cMoveWidth=this.itemWidth}if(this.moveSide=="l"){this.target.scrollLeft+=this.space}else{this.target.scrollLeft-=this.space}this.space=sourceSpace;if(this.cMoveWidth==this.itemWidth){this.cMoveWidth=0;if(this.Order!=null){this.moveSide=this.Order;this.Order=null;this.stopMove();this.play()}else{this.moveSide="l";this.pause()}}}else{this.target.scrollLeft=this.c1.offsetWidth-this.target.clientWidth;this.stopMove();this.play()}},moveTop:function(){if(this.c1.scrollHeight*2-this.target.clientHeight>this.target.scrollTop){sourceSpace=this.space;this.cMoveWidth+=this.space;if(this.cMoveWidth>this.itemWidth){this.space=this.space-(this.cMoveWidth-this.itemWidth);this.cMoveWidth=this.itemWidth}if(this.moveSide=="l"){this.target.scrollTop+=this.space}else{this.target.scrollTop-=this.space}this.space=sourceSpace;if(this.cMoveWidth==this.itemWidth){this.cMoveWidth=0;if(this.Order!=null){this.moveSide=this.Order;this.Order=null;this.stopMove();this.play()}else{this.moveSide="l";this.pause()}}}else{this.target.scrollTop=this.c1.offsetHeight-this.target.clientHeight;this.stopMove();this.play()}},play:function(){var _this=this;this.moveTimer=setInterval(function(){_this.move()},_this.speed)},stopMove:function(){clearInterval(this.moveTimer);clearTimeout(this.stayTimer)},pause:function(){this.stopMove();var _this=this;this.stayTimer=setTimeout(function(){_this.play()},_this.stay)},btnAct:function(side){this.Order=side=="l"?"l":"r";if(this.cMoveWidth==0){this.moveSide=this.Order;this.Order=null;this.stopMove();this.play()}},resetStatus:function(){clearInterval(this.moveTimer);clearTimeout(this.stayTimer);this.target.scrollLeft=0;this.target.scrollTop=0;this.cMoveWidth=0;var _this=this;this.stayTimer=setTimeout(function(){_this.play()},_this.stay)}};function showSelectChat(target){this.target=document.getElementById(target);this.chat=document.createElement("div");this.init()}showSelectChat.prototype={init:function(){this.target.style.position="relative";this.chat.style.cssText="position:absolute;";this.chat.innerHTML='<a href="/zixun/" target="_blank"><img src="/js/jsResource/selectChat.gif" border="0" /></a>';this.chat.style.display="none";document.body.appendChild(this.chat);var _this=this;this.target.onmouseup=function(e){e=e||window.event;var r="";if(document.selection){r=document.selection.createRange().text}else if(window.getSelection()){r=window.getSelection()}if(r!=""){var pageBody=document.documentElement?document.documentElement:document.body;var xpos=e.clientX+(pageBody&&pageBody.scrollLeft||0)-(pageBody.clientLeft||0);var ypos=e.clientY+(pageBody&&pageBody.scrollTop||0)-(pageBody.clientTop||0);_this.showChat(xpos,ypos)}};this.target.onmousedown=function(){_this.hideChat()}},showChat:function(xpos,ypos){var x=10;var y=10;this.chat.style.left=(xpos)+x+"px";this.chat.style.top=(ypos)+y+"px";this.chat.style.display="block"},hideChat:function(){this.chat.style.display="none"}};function showBigImg(target,tBigImgList){this.target=target;this.tBigImgList=tBigImgList;this.bigCss="overflow:hidden; position:absolute; z-index:100; display:none;";this.bigImgCss="display:block;";this.bigBoxList=new Array();this.bigImgList=new Array();this.widthArr=new Array();this.heightArr=new Array();this.pLeftArr=new Array();this.pTopArr=new Array();this.init();this.currentNum=null;this.tempWidth=0;this.tempHeight=0;this.tLpos=0;this.tTpos=0;this.chaTimer=null}showBigImg.prototype={init:function(){this.target=document.getElementById(this.target);var imgList=this.target.getElementsByTagName("img");if(imgList.length==0){return}if(this.tBigImgList&&imgList.length!=this.tBigImgList.length){return}var _this=this;var imgNum=imgList.length;for(var i=0;i<imgNum;i++){var bigImgBox=document.createElement("div");bigImgBox.style.cssText=this.bigCss;var bigImg=document.createElement("img");if(this.tBigImgList){bigImg.src=this.tBigImgList[i]}else{bigImg.src=imgList[i].src}bigImg.style.display="block";bigImgBox.style.width=0+"px";bigImgBox.style.height=0+"px";this.widthArr.push(bigImg.width);this.heightArr.push(bigImg.height);this.bigImgList.push(bigImg);var leftSpace=this.getSideSpace(imgList[i],"left")-(bigImg.width-imgList[i].offsetWidth)/2;var topSpace=this.getSideSpace(imgList[i],"top")-(bigImg.height-imgList[i].offsetHeight)/2;this.pLeftArr.push(leftSpace<0?0:leftSpace);this.pTopArr.push(topSpace<0?0:topSpace);bigImg.onmouseout=function(){_this.hideBig()};bigImgBox.appendChild(bigImg);this.target.appendChild(bigImgBox);this.bigBoxList.push(bigImgBox);var tempBox=imgList[i].parentNode;tempBox.num=i;tempBox.onmouseover=function(){_this.hideBig();_this.showBig(this.num);_this.currentNum=this.num}}},getSideSpace:function(obj,direction){var space=0;var parentOjb=obj;while(parentOjb!=null&&parentOjb!=document.body){space+=direction=="left"?parentOjb.offsetLeft:parentOjb.offsetTop;parentOjb=parentOjb.offsetParent}return space},showBig:function(num){clearTimeout(this.chaTimer);this.bigBoxList[num].style.display="block";this.chaProcess(num)},hideBig:function(){clearTimeout(this.chaTimer);if(this.currentNum!==null){this.bigBoxList[this.currentNum].style.display="none"}},chaProcess:function(num){var _this=this;if(this.tempWidth<this.widthArr[num]){this.tempWidth+=Math.round((this.widthArr[num]*0.1));this.tempHeight=Math.round((this.heightArr[num]*this.tempWidth)/this.widthArr[num]);this.tLpos+=(this.widthArr[num]/2*0.1);this.tTpos+=(this.heightArr[num]/2*0.1);this.bigBoxList[num].style.width=this.tempWidth+"px";this.bigBoxList[num].style.height=this.tempHeight+"px";this.bigImgList[num].style.width=this.tempWidth+"px";this.bigImgList[num].style.height=this.tempHeight+"px";this.bigBoxList[num].style.left=(this.pLeftArr[num]+(this.widthArr[num]-this.tempWidth)/2)+"px";this.bigBoxList[num].style.top=(this.pTopArr[num]+(this.heightArr[num]-this.tempHeight)/2)+"px";this.chaTimer=setTimeout(function(){_this.chaProcess(num)},30)}else{this.tempWidth=0;this.tempHeight=0;this.tLpos=0;this.tTpos=0}}}